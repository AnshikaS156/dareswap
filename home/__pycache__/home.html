{% extends 'base.html' %}
{% block body %}
<!--Hero section-->
<section class="hero-section">
        <br><br><br>
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8 mx-auto text-center">
                    <h1 class="display-3 fw-bold mb-4">
                        <i class="fas fa-bolt text-warning"></i> DareSwap
                    </h1>
                    <p class="lead mb-4">The ultimate platform to exchange fun, crazy, and exciting dares with friends! Challenge yourself, dare others, and create unforgettable memories.</p>
                    <div class="d-flex justify-content-center gap-3 flex-wrap">
                        <button class="btn btn-primary-custom btn-lg pulse-button" onclick="showRandomDare()">
                            <i class="fas fa-dice"></i> Get Random Dare
                        </button>
                        <button class="btn btn-success-custom btn-lg" onclick="scrollToDares()">
                            <i class="fas fa-eye"></i> Browse Dares
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="py-5">
        <div class="container">
            <div class="row g-4">
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card">
                        <i class="fas fa-fire fa-3x mb-3 text-warning"></i>
                        <h3 class="fw-bold">{{ total_dares }}</h3>
                        <p>Active Dares</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card">
                        <i class="fas fa-users fa-3x mb-3 text-info"></i>
                        <h3 class="fw-bold">{{ unique_creators }}</h3>
                        <p>Dare Masters</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card">
                        <i class="fas fa-trophy fa-3x mb-3 text-success"></i>
                        <h3 class="fw-bold">0</h3>
                        <p>Completed Dares</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="stats-card">
                        <i class="fas fa-heart fa-3x mb-3 text-danger"></i>
                        <h3 class="fw-bold">100%</h3>
                        <p>Fun Rating</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Dares Section -->
    <section class="py-5" id="dares-section">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="display-5 fw-bold text-white mb-3">
                    <i class="fas fa-star text-warning"></i> Featured Dares
                </h2>
                <p class="text-white-50">Check out these amazing dares from our community!</p>
            </div>
            
            <div class="row g-4" id="dares-container">
                {% if recent_dares %}
                    {% for dare in recent_dares %}
                    <div class="col-lg-6 col-md-6">
                        <div class="dare-card p-4 h-100">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <span class="dare-difficulty difficulty-{{ dare.Difficulty|lower }}">{{ dare.Difficulty }}</span>
                                <div class="text-muted">
                                    <i class="fas fa-heart text-danger"></i> {{ forloop.counter0|add:10 }}
                                </div>
                            </div>
                            <h5 class="fw-bold text-primary mb-3">{{ dare.DareTitle }}</h5>
                            <p class="text-muted mb-3">{{ dare.Description|truncatewords:20 }}</p>
                            <div class="mb-3">
                                <span class="category-badge">{{ dare.Category }}</span>
                                {% if dare.Tags %}
                                    <span class="category-badge">{{ dare.Tags }}</span>
                                {% endif %}
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-muted">by {{ dare.Name }}</small>
                                <div>
                                    <button class="btn btn-sm btn-outline-primary me-2" onclick="viewDare('{{ dare.DareTitle|escapejs }}', '{{ dare.Description|escapejs }}', '{{ dare.Difficulty }}', '{{ dare.Category }}', '{{ dare.Name|escapejs }}')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-success-custom" onclick="acceptDare('{{ dare.DareTitle|escapejs }}')">
                                        <i class="fas fa-check"></i> Accept
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="col-12 text-center text-white">
                        <i class="fas fa-exclamation-triangle fa-3x mb-3 opacity-50"></i>
                        <h4>No Dares Available</h4>
                        <p class="lead">Be the first to create a dare and start the fun!</p>
                        <a href="{% url 'create_dare' %}" class="btn btn-primary-custom btn-lg">
                            <i class="fas fa-plus"></i> Create First Dare
                        </a>
                    </div>
                {% endif %}
            </div>
            
            {% if recent_dares %}
            <div class="text-center mt-5">
                <a href="{% url 'current_dares' %}" class="btn btn-primary-custom btn-lg">
                    <i class="fas fa-eye"></i> View All Dares
                </a>
            </div>
            {% endif %}
        </div>
    </section>

    <!-- Random Dare Modal -->
    <div class="modal fade" id="randomDareModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0" style="border-radius: 20px;">
                <div class="modal-header bg-gradient" style="background: linear-gradient(45deg, #667eea, #764ba2); border-radius: 20px 20px 0 0;">
                    <h5 class="modal-title text-white fw-bold">
                        <i class="fas fa-dice"></i> Your Random Dare!
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center p-4">
                    <div id="randomDareContent">
                        <!-- Random dare content will be inserted here -->
                    </div>
                    <div class="mt-4">
                        <button class="btn btn-success-custom me-2" onclick="acceptRandomDare()">
                            <i class="fas fa-check"></i> Accept Challenge
                        </button>
                        <button class="btn btn-primary-custom" onclick="showRandomDare()">
                            <i class="fas fa-dice"></i> Get Another
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dare Details Modal -->
    <div class="modal fade" id="dareDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0" style="border-radius: 20px;">
                <div class="modal-header bg-gradient" style="background: linear-gradient(45deg, #4ecdc4, #44a08d); border-radius: 20px 20px 0 0;">
                    <h5 class="modal-title text-white fw-bold">
                        <i class="fas fa-info-circle"></i> Dare Details
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <div id="dareDetailsContent">
                        <!-- Dare details will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
        //Database dares array (populated from Django backend)
        const databaseDares = [
            {% for dare in dares %}
            {
                title: "{{ dare.DareTitle|escapejs }}",
                description: "{{ dare.Description|escapejs }}",
                difficulty: "{{ dare.Difficulty|lower }}",
                category: "{{ dare.Category }}",
                author: "{{ dare.Name|escapejs }}",
                deadline: "{{ dare.Deadline|date:'M d, Y' }}",
                tags: "{{ dare.Tags|escapejs }}"
            }{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];

        // Show random dare
        function showRandomDare() {
            if (databaseDares.length === 0) {
                alert('No dares available! Create the first dare to get started.');
                return;
            }
            
            const randomDare = databaseDares[Math.floor(Math.random() * databaseDares.length)];
            const modal = new bootstrap.Modal(document.getElementById('randomDareModal'));
            
            document.getElementById('randomDareContent').innerHTML = `
                <div class="mb-3">
                    <span class="dare-difficulty difficulty-${randomDare.difficulty} mb-3 d-inline-block">${randomDare.difficulty}</span>
                    <span class="category-badge">${randomDare.category}</span>
                </div>
                <h4 class="fw-bold text-primary mb-3">${randomDare.title}</h4>
                <p class="text-muted">${randomDare.description}</p>
                <small class="text-muted">Created by ${randomDare.author}</small>
                ${randomDare.deadline ? `<br><small class="text-muted">Deadline: ${randomDare.deadline}</small>` : ''}
            `;
            
            modal.show();
        }

        // Accept dare
        function acceptDare(dareTitle) {
            alert(`ðŸŽ‰ Challenge accepted! "${dareTitle}" - Good luck and have fun!`);
        }

        // Accept random dare
        function acceptRandomDare() {
            alert('ðŸŽ‰ Random challenge accepted! Good luck and have fun!');
            bootstrap.Modal.getInstance(document.getElementById('randomDareModal')).hide();
        }

        // View dare details
        function viewDare(title, description, difficulty, category, author) {
            const modal = new bootstrap.Modal(document.getElementById('dareDetailsModal'));
            
            document.getElementById('dareDetailsContent').innerHTML = `
                <div class="mb-3">
                    <span class="dare-difficulty difficulty-${difficulty.toLowerCase()}">${difficulty}</span>
                    <span class="category-badge ms-2">${category}</span>
                </div>
                <h4 class="fw-bold text-primary mb-3">${title}</h4>
                <p class="text-muted mb-3">${description}</p>
                <div class="border-top pt-3">
                    <small class="text-muted"><strong>Created by:</strong> ${author}</small>
                </div>
                <div class="mt-3">
                    <button class="btn btn-success-custom w-100" onclick="acceptDare('${title}')">
                        <i class="fas fa-check"></i> Accept This Dare
                    </button>
                </div>
            `;
            
            modal.show();
        }

        // Scroll to dares section
        function scrollToDares() {
            document.getElementById('dares-section').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }
    </script>
</body>
</html>
{% endblock %}